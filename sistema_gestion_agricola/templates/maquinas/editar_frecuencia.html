{% extends "base.html" %}

{% block title %}Editar Frecuencia{% endblock %}

{% block content %}
<div class="page-wrapper">
    <!-- Header -->
    <div class="dashboard-header hidden-item p-4 shadow rounded mb-4">
        <div class="header-topbar">
            <div class="header-title">
                <h2 class="section-title"><i class="bi bi-clock-history"></i> Editar Frecuencia</h2>
                <p class="section-subtitle d-none d-md-block opacity-75">Modifica los parámetros de mantenimiento del componente</p>
            </div>
            <div class="header-controls">
                <a href="{{ url_for('index') }}" 
                    class="btn btn-outline-primary btn-sm ms-auto">
                    <i class="bi bi-house"></i>
                    <span class="d-none d-md-block d-md-inline">Inicio</span>
                </a>
                <a href="{{ url_for('maquinas.ver_maquina', id=id_maquina) }}" 
                    class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-arrow-left"></i>
                    <span class="d-none d-md-block d-md-inline">Volver</span>
                </a>
                <button class="theme-toggle" id="themeToggle">
                    <i class="bi bi-moon-fill" id="themeIcon"></i>
                </button>
                <div class="calendar-badge fs-6 d-none d-lg-block">
                    <i class="bi bi-calendar3"></i> <span id="current-date"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulario editar frecuencia -->
    <div class="card-section hidden-item mx-auto" style="max-width: 600px;">
        <form method="POST" class="needs-validation" novalidate>
            <!-- Frecuencia -->
            <div class="mb-3">
                <label for="frecuencia" class="form-label">Frecuencia</label>
                <input type="number" 
                       name="frecuencia" 
                       id="frecuencia" 
                       class="form-control" 
                       min="1" 
                       required
                       value="{{ frecuencia.Frecuencia if frecuencia else '' }}">
                <div class="invalid-feedback">
                    Por favor ingrese una frecuencia válida.
                </div>
            </div>

            <!-- Unidad de tiempo -->
            <div class="mb-3">
                <label for="unidad_tiempo" class="form-label">Unidad de tiempo</label>
                <select name="unidad_tiempo" id="unidad_tiempo" class="form-select" required>
                    <option value="" disabled>Seleccione una unidad</option>
                    <option value="horas" {% if frecuencia and frecuencia['Unidad tiempo'] == 'horas' %}selected{% endif %}>Horas</option>
                    <option value="días" {% if frecuencia and frecuencia['Unidad tiempo'] == 'días' %}selected{% endif %}>Días</option>
                    <option value="semanas" {% if frecuencia and frecuencia['Unidad tiempo'] == 'semanas' %}selected{% endif %}>Semanas</option>
                    <option value="meses" {% if frecuencia and frecuencia['Unidad tiempo'] == 'meses' %}selected{% endif %}>Meses</option>
                </select>
                <div class="invalid-feedback">
                    Seleccione una unidad de tiempo válida.
                </div>
            </div>

            <!-- Criterio adicional -->
            <div class="mb-3">
                <label for="criterio_adicional" class="form-label">Criterio adicional</label>
                <input type="text" 
                       name="criterio_adicional" 
                       id="criterio_adicional" 
                       class="form-control"
                       value="{{ frecuencia['Criterio adicional'] if frecuencia else '' }}"
                       placeholder="Ej. cuando la presión baja... (opcional)">
            </div>

            <!-- Botón submit -->
            <div class="d-flex justify-content-center mt-4">
                <button type="submit" class="btn btn-agri-primary px-5">
                    <i class="bi bi-check-lg"></i> Guardar Frecuencia
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Validación Bootstrap 5 para formularios
(() => {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
            if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
            }
            form.classList.add('was-validated')
        }, false)
    })
})()
</script>

{% endblock %}
