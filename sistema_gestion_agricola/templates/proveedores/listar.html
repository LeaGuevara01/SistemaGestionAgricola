{% extends "base.html" %}

{% block content %}
<div class="page-wrapper">
    <!-- Header -->
    <div class="dashboard-header hidden-item p-4 mb-3 rounded">
        <div class="header-topbar">
            <div class="header-title">
                <h2 class="section-title"><i class="bi bi-people-fill"></i> Lista de Proveedores</h2>
                <p class="section-subtitle d-md-block opacity-75">Administra el cuaderno de proveedores</p>
            </div>
        </div>
        <div class="header-controls">
            <a href="{{ url_for('index') }}" 
                class="btn btn-outline-primary btn-sm ms-auto" 
                style="font-size: 1rem;">
                <i class="bi bi-house"></i> 
                <span class="d-none d-md-block d-md-inline">Inicio</span>
            </a>
            <a href="{{ url_for('proveedores.agregar_proveedor') }}" 
                class="btn btn-outline-primary btn-sm">
                <i class="bi bi-plus-lg"></i>
                <span class="d-none d-md-block d-md-inline">Proveedor</span>
            </a>
            <a href="{{ url_for('compras.registrar_compra') }}" 
                class="btn btn-outline-primary btn-sm">
                <i class="bi bi-cart-plus"></i>
                <span class="d-none d-md-block d-md-inline">Compra</span>
            </a>
            <button class="theme-toggle" id="themeToggle">
                <i class="bi bi-moon-fill" id="themeIcon"></i>
            </button>
            <div class="calendar-badge fs-6 d-none d-lg-block">
                <i class="bi bi-calendar3"></i> <span id="current-date"></span>
            </div>
        </div>
    </div>

  
    <!-- Lista de Proveedores -->
    <section class="page-section hidden-item mb-0">
        <h3 class="section-title">
            <i class="bi bi-list-ul"></i> Lista de Stock
        </h3>
        <!-- Tabla de Proveedores -->
        <div class="card-section hidden-item mb-0" style="border: none; box-shadow: none;">
            {% if proveedores %}
            <div id="tableView" class="table-view hidden-item">
                <div class="table-responsive hidden-item">
                    <table class="table table-hover hidden-item align-middle">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th class="d-none d-lg-table-cell">Localidad</th>
                                <th class="d-none d-lg-table-cell">Contacto</th>
                                <th>Tel√©fono</th>
                                <th class="d-none d-md-table-cell">Rubro</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in proveedores %}
                            <tr class="clickable-row" 
                                data-href="{{ url_for('proveedores.ver_proveedor', id=p.ID) }}"
                                role="button"
                                tabindex="0">
                                <td><strong>{{ p.Nombre }}</strong></td>
                                <td class="d-none d-lg-table-cell">{{ p.Localidad or '-' }}</td>
                                <td class="d-none d-lg-table-cell">{{ p.Contacto or '-' }}</td>
                                <td>{{ p.Telefono or '-' }}</td>
                                <td class="d-none d-md-table-cell">{{ p.Rubro or '-' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% else %}
            <p class="text-muted fst-italic">No hay proveedores registrados.</p>
            {% endif %}
        </div>
    </section>

{% endblock %}

{% block scripts %}
<script>
// Hacer clickeables las filas
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('tr.clickable-row').forEach(row => {
    row.addEventListener('click', () => {
      const href = row.getAttribute('data-href');
      if (href) window.location.href = href;
    });
  });
});
// Hacer navegables las filas
row.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    const href = row.getAttribute('data-href');
    if (href) window.location.href = href;
  }
});
</script>
{% endblock %}
